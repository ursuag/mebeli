select 'Перемещ.'||p0.ID as doc_name, 0 as kolvo_prihod, pl.kol_vo as kolvo_rashod, p0.date_per as date_doc, '' as gotovprod_name, 0 as prihod_area, (pl.kol_vo*listy.area/1000000.000) as rashod_area
from peremeschenie_listy as pl, peremeschenie_0 as p0, pilomat_listy as listy
where (id_sklad_otkuda=:ID_SKLAD) and (ID_PILOMAT_LISTY=:ID_LISTY) and (date_per>=:DATE_BEGIN) and (date_per<=:DATE_END) and (p0.id=pl.id_parent) and (pl.ID_PILOMAT_LISTY=listy.id)

union all

select 'Перемещ.'||p0.ID as doc_name, pl.kol_vo as kolvo_prihod, 0 as kolvo_rashod, p0.date_per as date_doc, '' as gotovprod_name, (pl.kol_vo*listy.area/1000000.000) as prihod_area, 0 as rashod_area
from peremeschenie_listy as pl, peremeschenie_0 as p0, pilomat_listy as listy
where (id_sklad_kuda=:ID_SKLAD) and (ID_PILOMAT_LISTY=:ID_LISTY) and (date_per>=:DATE_BEGIN) and (date_per<=:DATE_END) and (p0.id=pl.id_parent) and (pl.ID_PILOMAT_LISTY=listy.id)

union all

select 'Приход '||pl0.ID as doc_name, pl1.kol_vo as kolvo_prihod, 0 as kolvo_rashod, pl0.date_p as date_doc, '' as gotovprod_name, (pl1.kol_vo*listy.area/1000000.000) as prihod_area,  0 as rashod_area
from prihod_listy_0 as pl0, prihod_listy_1 as pl1, pilomat_listy as listy
where (pl0.ID_SKLAD=:ID_SKLAD) and (pl1.ID_LISTY=:ID_LISTY) and (pl0.date_p>=:DATE_BEGIN) and (pl0.date_p<=:DATE_END) and (pl0.id=pl1.id_parent) and (pl1.ID_LISTY=listy.id)

union all

select 'Акт распила '||ar.ID as doc_name, 0 as kolvo_prihod, arl.kol_vo as kolvo_rashod, ar.date_r as date_doc, '' as gotovprod_name, 0 as prihod_area, (arl.kol_vo*listy.area/1000000.000) as rashod_area
from akt_raspil as ar, akt_raspil_listy as arl, pilomat_listy as listy
where (arl.ID_PILOMAT_LISTY=:ID_LISTY) and (ar.date_r>=:DATE_BEGIN) and (ar.date_r<=:DATE_END) and (ar.id=arl.id_parent) and (arl.ID_PILOMAT_LISTY=listy.id)

union all

select 'Акт списания '||sp0.ID as doc_name, 0 as kolvo_prihod, spl.kol_vo as kolvo_rashod, sp0.date_spis as date_doc, '' as gotovprod_name, 0 as prihod_area, (spl.kol_vo*listy.area/1000000.000) as rashod_area
from spisanie_0 as sp0, spisanie_listy as spl, pilomat_listy as listy
where (sp0.id_sklad=:ID_SKLAD) and (spl.ID_PILOMAT_LISTY=:ID_LISTY) and (sp0.date_spis>=:DATE_BEGIN) and (sp0.DATE_SPIS<=:DATE_END) and (sp0.id=spl.id_parent) and (spl.ID_PILOMAT_LISTY=listy.id)